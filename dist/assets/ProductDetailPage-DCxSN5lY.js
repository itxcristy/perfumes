import{c as I,j as e,o as U,b as A,v as M,m as p,X as O,u as V,F as W,q as E,r as z,l as B,L as P,I as Y,J as Q,H as J}from"./index-CZfeFpFF.js";import{r as l,f as X}from"./router-ji7Lkway.js";import{U as Z}from"./upload-C6HQKQk9.js";import{S as G,P as T}from"./ProductRecommendations-DiXyAXOw.js";import{M as K}from"./Modal-DVXVptVo.js";import{T as ee}from"./TrustBadges-By3Ep7SK.js";import{T as se,R as te,S as ae,a as re}from"./SocialProof-qZkkTpQc.js";import{M as ie,P as le}from"./TrustSignals-DhYlgKdg.js";import{T as oe}from"./truck-CLaVScap.js";import{R as ce}from"./rotate-ccw-DHyFyuU3.js";import{S as ne}from"./square-pen-sypM05a8.js";import"./vendor-DRGAkOw0.js";import"./MobileProductCarousel-C3pRfQE8.js";import"./MobileTouchButton-C8zq9LKe.js";import"./chevron-left-C9hlcGbE.js";import"./arrow-right-DTC_1ZP5.js";import"./users-DYlva5Sj.js";import"./credit-card-DOwGzToR.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],me=I("message-square",de);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]],he=I("thumbs-up",xe),ue=({review:t,onHelpful:g})=>{var f,o;const[d,j]=l.useState(!1),y=()=>{g&&(g(t.id),j(!0))},m=t.createdAt||new Date(t.created_at||""),s=((f=t.profiles)==null?void 0:f.full_name)||"Anonymous",b=(o=t.profiles)==null?void 0:o.avatar_url;return e.jsx("div",{className:"py-6 border-b border-gray-200 last:border-b-0",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("img",{src:b||`https://api.dicebear.com/8.x/initials/svg?seed=${s}`,alt:s,className:"h-12 w-12 rounded-full object-cover bg-gray-200"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:s}),t.isVerifiedPurchase&&e.jsxs("div",{className:"flex items-center gap-1 text-xs bg-green-100 text-green-700 px-2 py-1 rounded-full",children:[e.jsx(U,{className:"h-3 w-3"}),"Verified Purchase"]})]}),e.jsx("p",{className:"text-sm text-gray-500",children:m instanceof Date?m.toLocaleDateString():new Date(m).toLocaleDateString()})]}),e.jsx("div",{className:"flex items-center",children:[...Array(5)].map((x,c)=>e.jsx(A,{className:`h-5 w-5 ${c<t.rating?"text-yellow-400 fill-current":"text-gray-300"}`},c))})]}),t.title&&e.jsx("h5",{className:"font-medium text-gray-900 mb-2",children:t.title}),t.comment&&e.jsx("p",{className:"text-gray-700 mb-3 leading-relaxed",children:t.comment}),t.images&&t.images.length>0&&e.jsxs("div",{className:"flex gap-2 mb-3",children:[t.images.slice(0,3).map((x,c)=>e.jsx("img",{src:x,alt:`Review image ${c+1}`,className:"h-16 w-16 object-cover rounded-lg border border-gray-200"},c)),t.images.length>3&&e.jsx("div",{className:"h-16 w-16 bg-gray-100 rounded-lg border border-gray-200 flex items-center justify-center",children:e.jsxs("span",{className:"text-xs text-gray-600",children:["+",t.images.length-3]})})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-4",children:[e.jsxs("button",{onClick:y,disabled:d,className:`flex items-center gap-2 text-sm px-3 py-1 rounded-full transition-colors ${d?"bg-blue-100 text-blue-700 cursor-not-allowed":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(he,{className:`h-4 w-4 ${d?"fill-current":""}`}),e.jsxs("span",{children:[d?"Helpful!":"Helpful",t.helpfulCount&&t.helpfulCount>0&&` (${t.helpfulCount})`]})]}),!t.isApproved&&e.jsx("span",{className:"text-xs text-yellow-600 bg-yellow-100 px-2 py-1 rounded-full",children:"Pending Approval"})]})]})]})})},ge=({onSubmit:t})=>{const[g,d]=l.useState(0),[j,y]=l.useState(0),[m,s]=l.useState(""),[b,f]=l.useState(""),[o,x]=l.useState([]),{showNotification:c}=M(),v=r=>{const i=r.target.files;i&&Array.from(i).forEach(h=>{if(o.length<3){const n=new FileReader;n.onload=S=>{x(N=>{var w;return[...N,(w=S.target)==null?void 0:w.result]})},n.readAsDataURL(h)}})},R=r=>{x(i=>i.filter((h,n)=>n!==r))},k=r=>{if(r.preventDefault(),g===0){c({type:"error",title:"Rating required",message:"Please select a star rating."});return}if(b.trim()===""){c({type:"error",title:"Comment required",message:"Please write a comment about the product."});return}t(g,b,m,o),d(0),s(""),f(""),x([])};return e.jsxs("form",{onSubmit:k,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Your Rating"}),e.jsx("div",{className:"flex items-center space-x-1",children:[...Array(5)].map((r,i)=>{const h=i+1;return e.jsx(p.button,{type:"button",onMouseEnter:()=>y(h),onMouseLeave:()=>y(0),onClick:()=>d(h),whileHover:{scale:1.2,y:-2},whileTap:{scale:.9},className:"p-1",children:e.jsx(A,{className:`h-7 w-7 transition-colors ${h<=(j||g)?"text-yellow-400 fill-current":"text-gray-300"}`})},h)})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-2",children:"Review Title (Optional)"}),e.jsx("input",{type:"text",id:"title",value:m,onChange:r=>s(r.target.value),className:"input-field",placeholder:"Summarize your review in a few words",maxLength:100})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"comment",className:"block text-sm font-medium text-gray-700 mb-2",children:"Your Review *"}),e.jsx("textarea",{id:"comment",rows:5,value:b,onChange:r=>f(r.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Share your thoughts about the product...",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Add Photos (Optional)"}),e.jsxs("div",{className:"space-y-3",children:[o.length<3&&e.jsxs("label",{className:"flex items-center justify-center w-full h-32 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-indigo-400 transition-colors",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Z,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Click to upload photos"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Up to 3 images, max 5MB each"})]}),e.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:v,className:"hidden"})]}),o.length>0&&e.jsx("div",{className:"flex gap-3",children:o.map((r,i)=>e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:r,alt:`Review image ${i+1}`,className:"h-20 w-20 object-cover rounded-lg border border-gray-200"}),e.jsx("button",{type:"button",onClick:()=>R(i),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 transition-colors",children:e.jsx(O,{className:"h-3 w-3"})})]},i))})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(p.button,{type:"submit",className:"bg-indigo-600 text-white px-6 py-3 rounded-lg hover:bg-indigo-700 transition-colors font-medium",whileHover:{scale:1.02},whileTap:{scale:.98},children:"Submit Review"})})]})},He=()=>{const{id:t}=X(),{products:g,loading:d,fetchReviewsForProduct:j,submitReview:y}=V(),{user:m}=W(),s=g.find(a=>a.id===t),{addItem:b}=E(),{addItem:f,isInWishlist:o}=z(),{addToRecentlyViewed:x}=B(),{showNotification:c}=M(),[v,R]=l.useState([]),[k,r]=l.useState(!0),[i,h]=l.useState(0),[n,S]=l.useState(1),[N,w]=l.useState("description"),[$,C]=l.useState(!1);if(l.useEffect(()=>{s&&(x(s.id),(async()=>{r(!0);const u=await j(s.id);R(u),r(!1)})())},[s,j,x]),d)return e.jsx("div",{className:"min-h-screen",children:e.jsx(P,{})});if(!s)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Product Not Found"}),e.jsx("p",{className:"text-gray-600",children:"The product you're looking for doesn't exist."})]})});const H=()=>{b(s,n)},q=()=>{f(s)},L=async(a,u)=>{if(!m){c({type:"error",title:"Login Required",message:"You must be logged in to submit a review."});return}await y({product_id:s.id,user_id:m.id,rating:a,comment:u});const F=await j(s.id);R(F),c({type:"success",title:"Review Submitted",message:"Thank you for your feedback!"}),C(!1)},_=[{icon:oe,text:"Free shipping on orders over $50"},{icon:ce,text:"30-day return policy"},{icon:G,text:"2-year warranty included"}],D=[{id:"description",name:"Description"},{id:"reviews",name:`Reviews (${v.length})`},{id:"shipping",name:"Shipping Info"}];return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12",children:[e.jsxs(p.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:[e.jsx("div",{className:"aspect-square mb-4",children:e.jsx("img",{src:s.images[i]||s.images[0],alt:s.name,className:"w-full h-full object-cover rounded-xl shadow-lg"})}),s.images.length>1&&e.jsx("div",{className:"grid grid-cols-5 gap-4",children:s.images.map((a,u)=>e.jsx("button",{onClick:()=>h(u),className:`aspect-square rounded-lg overflow-hidden border-2 transition-all ${i===u?"border-indigo-500 scale-105":"border-gray-200"}`,children:e.jsx("img",{src:a,alt:"",className:"w-full h-full object-cover"})},u))})]}),e.jsxs(p.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:s.name}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(se,{isHot:s.is_featured,salesIncrease:15}),e.jsx(ie,{freeShipping:s.price>=50,warranty:!0,returns:!0})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(te,{rating:s.rating,reviewCount:v.length,className:"mb-3"}),e.jsx("a",{href:"#reviews",onClick:()=>w("reviews"),className:"text-sm text-indigo-600 hover:text-indigo-800 font-medium",children:"Read all reviews â†’"})]}),e.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[e.jsxs("span",{className:"text-4xl font-bold text-gray-900",children:["$",s.price]}),s.originalPrice&&e.jsxs("span",{className:"text-2xl text-gray-500 line-through",children:["$",s.originalPrice]})]}),e.jsx(ae,{stock:s.stock,lowStockThreshold:10,className:"mb-4"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Quantity"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg",children:[e.jsx("button",{onClick:()=>S(Math.max(1,n-1)),className:"p-3 hover:bg-gray-50 transition-colors",children:e.jsx(Y,{className:"h-4 w-4"})}),e.jsx("span",{className:"px-6 py-3 border-x border-gray-300 min-w-[80px] text-center",children:n}),e.jsx("button",{onClick:()=>S(Math.min(s.stock,n+1)),className:"p-3 hover:bg-gray-50 transition-colors",disabled:n>=s.stock,children:e.jsx(Q,{className:"h-4 w-4"})})]}),e.jsxs("span",{className:"text-sm text-gray-600",children:[s.stock," available"]})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(p.button,{onClick:H,disabled:s.stock===0,className:"flex-1 btn-primary !text-lg",whileHover:s.stock>0?{scale:1.02}:{},whileTap:s.stock>0?{scale:.98}:{},children:e.jsx("span",{children:s.stock===0?"Out of Stock":"Add to Cart"})}),e.jsx(p.button,{onClick:q,className:`p-4 border rounded-xl transition-colors ${o(s.id)?"border-red-300 bg-red-50 text-red-500":"border-gray-300 hover:bg-gray-50"}`,whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx(J,{className:"h-6 w-6",fill:o(s.id)?"currentColor":"none"})})]}),e.jsx("div",{className:"space-y-4 pt-6 border-t border-gray-200",children:_.map((a,u)=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(a.icon,{className:"h-5 w-5 text-green-500"})," ",e.jsx("span",{className:"text-gray-700",children:a.text})]},u))}),e.jsx("div",{className:"pt-6",children:e.jsx(ee,{variant:"compact",className:"justify-start"})})]})]}),e.jsx(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"mt-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(re,{productId:s.id,showRecentPurchases:!0,showViewingCount:!0,showCustomerCount:!0}),e.jsx(le,{})]})}),e.jsx(p.div,{id:"reviews",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"mt-16",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex space-x-8 px-6",children:D.map(a=>e.jsx("button",{onClick:()=>w(a.id),className:`py-4 px-1 border-b-2 font-medium text-sm ${N===a.id?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:a.name},a.id))})}),e.jsxs("div",{className:"p-6",children:[N==="description"&&e.jsx("div",{className:"prose max-w-none",children:e.jsx("p",{className:"text-gray-700 leading-relaxed",children:s.description})}),N==="reviews"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Customer Reviews"}),e.jsxs("button",{onClick:()=>C(!0),className:"btn-primary",children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:"Write a Review"})]})]}),k?e.jsx(P,{}):v.length>0?e.jsx("div",{className:"space-y-4",children:v.map(a=>e.jsx(ue,{review:a},a.id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(me,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No reviews yet"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Be the first to share your thoughts on this product."})]})]}),N==="shipping"&&e.jsx("div",{className:"prose max-w-none",children:e.jsx("p",{children:"Shipping info goes here..."})})]})]})})]}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 space-y-12",children:[e.jsx(T,{currentProduct:s,type:"frequently-bought",maxItems:3,showAddToCart:!0,className:"bg-neutral-50 rounded-2xl p-8"}),e.jsx(T,{currentProduct:s,type:"related",maxItems:4,showAddToCart:!0}),e.jsx(T,{currentProduct:s,type:"you-may-like",maxItems:6,showAddToCart:!0,layout:"grid"})]}),e.jsx(K,{isOpen:$,onClose:()=>C(!1),title:"Write a Review",children:e.jsx(ge,{onSubmit:L})})]})};export{He as ProductDetailPage,He as default};
