var e,t=Object.defineProperty,r=Object.defineProperties,s=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,a=(e,r,s)=>r in e?t(e,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[r]=s,l=(e,t)=>{for(var r in t||(t={}))i.call(t,r)&&a(e,r,t[r]);if(n)for(var r of n(t))o.call(t,r)&&a(e,r,t[r]);return e},c=(e,t)=>r(e,s(t)),d=(e,t,r)=>a(e,"symbol"!=typeof t?t+"":t,r),u=(e,t,r)=>new Promise((s,n)=>{var i=e=>{try{a(r.next(e))}catch(t){n(t)}},o=e=>{try{a(r.throw(e))}catch(t){n(t)}},a=e=>e.done?s(e.value):Promise.resolve(e.value).then(i,o);a((r=r.apply(e,t)).next())});import{r as h,j as m,a as f,X as g,I as p,T as y,C as b,b as w,A as x,S as v,U as S,M as C,L as k,E,c as j,d as P,W as T}from"./vendor-react-CsQATWT2.js";const M=new class{constructor(){d(this,"token",null),this.token=localStorage.getItem("auth_token")}setToken(e){this.token=e,e?localStorage.setItem("auth_token",e):localStorage.removeItem("auth_token")}getToken(){const e=localStorage.getItem("auth_token");return e&&(this.token=e),this.token}request(e){return u(this,arguments,function*(e,t={}){var r;const s=`http://localhost:5000/api${e}`,n=l({"Content-Type":"application/json"},t.headers),i=this.getToken();i&&(n.Authorization=`Bearer ${i}`);try{const e=yield fetch(s,c(l({},t),{headers:n})),i=yield e.json();if(!e.ok)throw new Error((null==(r=i.error)?void 0:r.message)||"API request failed");return i}catch(o){const t="/auth/me"===e,r=o instanceof Error&&o.message.includes("401"),s=!this.getToken();if(t&&r&&s)throw o;throw o}})}get(e){return u(this,null,function*(){return this.request(e,{method:"GET"})})}post(e,t){return u(this,null,function*(){return this.request(e,{method:"POST",body:JSON.stringify(t)})})}put(e,t){return u(this,null,function*(){return this.request(e,{method:"PUT",body:JSON.stringify(t)})})}delete(e){return u(this,null,function*(){return this.request(e,{method:"DELETE"})})}register(e,t,r,s="customer"){return u(this,null,function*(){const n=yield this.post("/auth/register",{email:e,password:t,fullName:r,role:s});return n.token&&this.setToken(n.token),n})}login(e,t){return u(this,null,function*(){const r=yield this.post("/auth/login",{email:e,password:t});return r.token&&this.setToken(r.token),r})}logout(){return u(this,null,function*(){this.setToken(null)})}getCurrentUser(){return u(this,null,function*(){return this.get("/auth/me")})}updateProfile(e){return u(this,null,function*(){return this.put("/auth/profile",e)})}getProducts(e){return u(this,null,function*(){const t=new URLSearchParams;(null==e?void 0:e.page)&&t.append("page",e.page.toString()),(null==e?void 0:e.limit)&&t.append("limit",e.limit.toString()),(null==e?void 0:e.categoryId)&&t.append("categoryId",e.categoryId),(null==e?void 0:e.search)&&t.append("search",e.search),(null==e?void 0:e.featured)&&t.append("featured","true"),(null==e?void 0:e.bestSellers)&&t.append("bestSellers","true"),(null==e?void 0:e.latest)&&t.append("latest","true"),(null==e?void 0:e.sellerId)&&t.append("sellerId",e.sellerId),(null==e?void 0:e.showOnHomepage)&&t.append("showOnHomepage","true");const r=t.toString();return this.get("/products"+(r?"?"+r:""))})}getProduct(e){return u(this,null,function*(){return this.get(`/products/${e}`)})}createProduct(e){return u(this,null,function*(){return this.post("/products",e)})}updateProduct(e,t){return u(this,null,function*(){return this.put(`/products/${e}`,t)})}deleteProduct(e){return u(this,null,function*(){return this.delete(`/products/${e}`)})}getCategories(){return u(this,null,function*(){return this.get("/categories")})}getCategory(e){return u(this,null,function*(){return this.get(`/categories/${e}`)})}createCategory(e){return u(this,null,function*(){return this.post("/categories",e)})}updateCategory(e,t){return u(this,null,function*(){return this.put(`/categories/${e}`,t)})}deleteCategory(e){return u(this,null,function*(){return this.delete(`/categories/${e}`)})}getCart(){return u(this,null,function*(){return this.get("/cart")})}addToCart(e,t,r){return u(this,null,function*(){return this.post("/cart",{productId:e,quantity:t,variantId:r})})}updateCartItem(e,t){return u(this,null,function*(){return this.put(`/cart/${e}`,{quantity:t})})}removeFromCart(e){return u(this,null,function*(){return this.delete(`/cart/${e}`)})}clearCart(){return u(this,null,function*(){return this.delete("/cart")})}getWishlist(){return u(this,null,function*(){return this.get("/wishlist")})}addToWishlist(e){return u(this,null,function*(){return this.post("/wishlist",{productId:e})})}removeFromWishlist(e){return u(this,null,function*(){return this.delete(`/wishlist/${e}`)})}getAddresses(){return u(this,null,function*(){return this.get("/addresses")})}getAddress(e){return u(this,null,function*(){return this.get(`/addresses/${e}`)})}createAddress(e){return u(this,null,function*(){return this.post("/addresses",e)})}updateAddress(e,t){return u(this,null,function*(){return this.put(`/addresses/${e}`,t)})}deleteAddress(e){return u(this,null,function*(){return this.delete(`/addresses/${e}`)})}getOrders(){return u(this,null,function*(){return this.get("/orders")})}getOrder(e){return u(this,null,function*(){return this.get(`/orders/${e}`)})}createOrder(e){return u(this,null,function*(){return this.post("/orders",e)})}updateOrderStatus(e,t){return u(this,null,function*(){return this.put(`/orders/${e}/status`,{status:t})})}getPaymentMethods(){return u(this,null,function*(){return this.get("/payment-methods")})}getPaymentMethod(e){return u(this,null,function*(){return this.get(`/payment-methods/${e}`)})}createPaymentMethod(e){return u(this,null,function*(){return this.post("/payment-methods",e)})}updatePaymentMethod(e,t){return u(this,null,function*(){return this.put(`/payment-methods/${e}`,t)})}deletePaymentMethod(e){return u(this,null,function*(){return this.delete(`/payment-methods/${e}`)})}setDefaultPaymentMethod(e){return u(this,null,function*(){return this.put(`/payment-methods/${e}/set-default`,{})})}getNotificationPreferences(){return u(this,null,function*(){return this.get("/notification-preferences")})}createNotificationPreferences(e){return u(this,null,function*(){return this.post("/notification-preferences",e)})}updateNotificationPreferences(e){return u(this,null,function*(){return this.put("/notification-preferences",e)})}patch(e){return u(this,arguments,function*(e,t={}){return this.request(e,{method:"PATCH",body:JSON.stringify(t)})})}},I=localStorage.getItem("auth_token");I&&M.setToken(I);const R=h.createContext(void 0),N=()=>{const e=h.useContext(R);if(!e)throw new Error("useError must be used within an ErrorProvider");return e},O=({children:e})=>{const[t,r]=h.useState(null);return m.jsx(R.Provider,{value:{error:t,setError:r,clearError:()=>r(null)},children:e})},A=h.createContext(void 0),q=()=>{const e=h.useContext(A);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e},L=({children:e})=>{const[t,r]=h.useState(null),[s,n]=h.useState(!0),[i,o]=h.useState(!1),[a,l]=h.useState("login"),{setError:c}=N();h.useEffect(()=>{u(null,null,function*(){try{const e=localStorage.getItem("auth_token");if(e){M.setToken(e);const t=yield M.getCurrentUser();t.user?(r(t.user),c(null)):(localStorage.removeItem("auth_token"),M.setToken(null),r(null))}else r(null)}catch(e){localStorage.removeItem("auth_token"),M.setToken(null),r(null)}finally{n(!1)}})},[]);const d=(e,t)=>u(null,null,function*(){try{n(!0);const s=yield M.login(e,t);if(!s.token||!s.user)throw new Error("Login failed");M.setToken(s.token),r(s.user),c(null)}catch(s){const e=s instanceof Error?s.message:"Login failed";throw c(e),localStorage.removeItem("auth_token"),M.setToken(null),r(null),s}finally{n(!1)}}),f=(e,t,s)=>u(null,null,function*(){try{n(!0);const i=(null==s?void 0:s.fullName)||"User",o=(null==s?void 0:s.role)||"customer",a=yield M.register(e,t,i,o);if(!a.token||!a.user)throw new Error("Registration failed");M.setToken(a.token),r(a.user),c(null)}catch(i){const e=i instanceof Error?i.message:"Registration failed";throw c(e),localStorage.removeItem("auth_token"),M.setToken(null),r(null),i}finally{n(!1)}}),g=()=>u(null,null,function*(){try{n(!0),yield M.logout(),r(null),localStorage.removeItem("user_preferences"),localStorage.removeItem("cart_items"),c(null)}catch(e){const t=e instanceof Error?e.message:"Logout failed";throw c(t),e}finally{n(!1)}}),p={user:t,loading:s,login:(e,t)=>u(null,null,function*(){try{return yield d(e,t),null}catch(r){return r instanceof Error?r.message:"Login failed"}}),logout:()=>u(null,null,function*(){yield g()}),register:e=>u(null,null,function*(){try{return yield f(e.email,e.password,{fullName:e.name||"User"}),!0}catch(t){return!1}}),signIn:d,signUp:f,signOut:g,resetPassword:e=>u(null,null,function*(){throw new Error("Password reset not yet implemented")}),updatePassword:e=>u(null,null,function*(){throw new Error("Password update not yet implemented")}),resendVerification:()=>u(null,null,function*(){throw new Error("Email verification not yet implemented")}),updateProfile:e=>u(null,null,function*(){try{if(!t)throw new Error("No user is currently authenticated");const s=yield M.updateProfile(e);s.user&&r(s.user)}catch(s){const e=s instanceof Error?s.message:"Profile update failed";throw c(e),s}}),openMobileAuth:(e="login")=>{l(e),o(!0)},closeMobileAuth:()=>{o(!1)},isMobileAuthOpen:i,mobileAuthMode:a};return m.jsx(A.Provider,{value:p,children:e})},z=h.createContext(void 0),F=()=>{const e=h.useContext(z);if(!e)throw new Error("useNotification must be used within NotificationProvider");return e},_=({children:e})=>{const[t,r]=h.useState([]),s=h.useCallback(e=>{r(t=>t.filter(t=>t.id!==e))},[]),n=h.useCallback(e=>{const t=`notification-${Date.now()}-${Math.random()}`,n=c(l({},e),{id:t,duration:e.duration||5e3});r(e=>[...e,n]),setTimeout(()=>{s(t)},n.duration)},[s]),i=h.useCallback((e,t)=>{n({type:"success",title:e,message:t})},[n]),o=h.useCallback((e,t)=>{n({type:"error",title:e,message:t})},[n]),a=h.useCallback((e,t)=>{n({type:"warning",title:e,message:t})},[n]),d=h.useCallback((e,t)=>{n({type:"info",title:e,message:t})},[n]);return m.jsxs(z.Provider,{value:{showNotification:n,showSuccess:i,showError:o,showWarning:a,showInfo:d},children:[e,f.createPortal(m.jsx(D,{notifications:t,onRemove:s}),document.body)]})},D=({notifications:e,onRemove:t})=>0===e.length?null:m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"hidden md:block",style:{position:"fixed",bottom:"1.5rem",right:"1.5rem",zIndex:99999,display:"flex",flexDirection:"column",gap:"0.75rem",maxWidth:"400px",width:"100%",pointerEvents:"none"},children:e.map(e=>m.jsx(W,{notification:e,onRemove:t},e.id))}),m.jsx("div",{className:"md:hidden",style:{position:"fixed",bottom:"1rem",left:"50%",transform:"translateX(-50%)",zIndex:99999,display:"flex",flexDirection:"column",gap:"0.75rem",maxWidth:"calc(100vw - 2rem)",width:"100%",pointerEvents:"none"},children:e.map(e=>m.jsx(W,{notification:e,onRemove:t,isMobile:!0},e.id))})]}),W=({notification:e,onRemove:t,isMobile:r=!1})=>{const{id:s,type:n,title:i,message:o}=e,a=(()=>{switch(n){case"success":return{bg:"#f0fdf4",border:"#86efac",text:"#166534"};case"error":return{bg:"#fef2f2",border:"#fca5a5",text:"#991b1b"};case"warning":return{bg:"#fffbeb",border:"#fcd34d",text:"#92400e"};case"info":return{bg:"#eff6ff",border:"#93c5fd",text:"#1e40af"};default:return{bg:"#f3f4f6",border:"#d1d5db",text:"#374151"}}})();return m.jsxs("div",{style:{backgroundColor:a.bg,border:`1px solid ${a.border}`,borderRadius:r?"0.5rem":"0.75rem",padding:r?"0.875rem":"1rem",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",display:"flex",alignItems:"flex-start",gap:"0.75rem",pointerEvents:"auto",animation:r?"slideUp 0.3s ease-out":"slideIn 0.3s ease-out",width:"100%",minHeight:r?"60px":"auto"},children:[m.jsx("div",{style:{flexShrink:0,marginTop:"0.125rem"},children:(()=>{switch(n){case"success":return m.jsx(w,{className:"h-5 w-5 text-green-600"});case"error":return m.jsx(b,{className:"h-5 w-5 text-red-600"});case"warning":return m.jsx(y,{className:"h-5 w-5 text-yellow-600"});case"info":return m.jsx(p,{className:"h-5 w-5 text-blue-600"})}})()}),m.jsxs("div",{style:{flex:1,minWidth:0},children:[m.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:600,color:a.text,marginBottom:"0.25rem"},children:i}),m.jsx("p",{style:{fontSize:"0.875rem",color:a.text,opacity:.8},children:o})]}),m.jsx("button",{onClick:()=>t(s),style:{flexShrink:0,padding:r?"0.5rem":"0.25rem",borderRadius:"0.375rem",border:"none",background:"transparent",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"background-color 0.2s",minWidth:r?"44px":"auto",minHeight:r?"44px":"auto"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="rgba(0, 0, 0, 0.05)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"},"aria-label":"Close notification",children:m.jsx(g,{className:r?"h-5 w-5":"h-4 w-4",style:{color:a.text,opacity:.6}})}),m.jsx("style",{children:"\n          @keyframes slideIn {\n            from {\n              transform: translateX(100%);\n              opacity: 0;\n            }\n            to {\n              transform: translateX(0);\n              opacity: 1;\n            }\n          }\n\n          @keyframes slideUp {\n            from {\n              transform: translateY(100%);\n              opacity: 0;\n            }\n            to {\n              transform: translateY(0);\n              opacity: 1;\n            }\n          }\n        "})]})},B=h.createContext(void 0),$=()=>{const e=h.useContext(B);if(!e)throw new Error("useCart must be used within a CartProvider");return e},H=({children:e})=>{const{user:t}=q(),{showNotification:r}=F(),[s,n]=h.useState([]),[i,o]=h.useState(!1),[a,d]=h.useState([]),f=h.useCallback(()=>{try{const e=localStorage.getItem("guestCart");if(e){const t=JSON.parse(e);return d(t),t}}catch(e){}return[]},[]),g=h.useCallback(e=>{try{localStorage.setItem("guestCart",JSON.stringify(e)),d(e)}catch(t){}},[]),p=h.useCallback(()=>u(null,null,function*(){if(t&&a.length>0)try{for(const e of a)yield M.addToCart(e.product.id,e.quantity,e.variantId);return localStorage.removeItem("guestCart"),d([]),yield y(),!0}catch(e){return!1}return!1}),[t,a]),y=h.useCallback(()=>u(null,null,function*(){var e;o(!0);try{if(t){const t=yield M.getCart(),r=t.items||(null==(e=t.data)?void 0:e.items)||t.data||[];n(r)}else{const e=f();n(e)}}catch(s){t&&r({type:"error",title:"Error",message:"Failed to load cart"}),n([])}finally{o(!1)}}),[t,f,r]);h.useEffect(()=>{t?p():f()},[t]),h.useEffect(()=>{y()},[t]);const b=h.useCallback((e,s=1,i)=>u(null,null,function*(){try{if(t)yield M.addToCart(e.id,s,i),yield y(),r({type:"success",title:"Added to Cart",message:`${e.name} has been added to your cart.`});else{const t=a.findIndex(t=>t.product.id===e.id&&t.variantId===i);let o;if(t>=0)o=a.map((e,r)=>r===t?c(l({},e),{quantity:e.quantity+s}):e);else{const t=l({id:`guest-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,product:e,quantity:s},i&&{variantId:i});o=[...a,t]}g(o),n(o),r({type:"success",title:"Added to Cart",message:`${e.name} has been added to your cart.`})}}catch(o){r({type:"error",title:"Error",message:"Failed to add to cart"})}}),[t,a,y,g,r]),w=h.useCallback((e,s)=>u(null,null,function*(){try{if(t)yield M.updateCartItem(e,s),yield y();else{const t=a.map(t=>t.id===e?c(l({},t),{quantity:s}):t);g(t),n(t)}}catch(i){r({type:"error",title:"Error",message:"Failed to update cart"})}}),[t,a,y,g,r]),x=h.useCallback(e=>u(null,null,function*(){try{if(t)yield M.removeFromCart(e),yield y();else{const t=a.filter(t=>t.id!==e);g(t),n(t)}r({type:"info",title:"Removed from Cart",message:"Item removed from your cart."})}catch(s){r({type:"error",title:"Error",message:"Failed to remove from cart"})}}),[t,a,y,g,r]),v=h.useCallback(()=>u(null,null,function*(){try{t&&(yield M.clearCart()),localStorage.removeItem("guestCart"),n([]),d([]),r({type:"success",title:"Cart Cleared",message:"Cart cleared successfully."})}catch(e){r({type:"error",title:"Error",message:"Failed to clear cart"})}}),[t,r]),S=s.reduce((e,t)=>{if(t.product&&"number"==typeof t.product.price){return e+t.product.price*t.quantity}return e},0),C=s.reduce((e,t)=>e+t.quantity,0),k=h.useCallback((e,t=1,r)=>u(null,null,function*(){yield b(e,t,r)}),[b]),E=h.useCallback((e,t)=>u(null,null,function*(){const r=s.find(r=>r.product.id===e&&(t?r.variantId===t:!r.variantId));r&&r.id&&(yield x(r.id))}),[s,x]),j=h.useCallback((e,t,r)=>u(null,null,function*(){const n=s.find(t=>t.product.id===e&&(r?t.variantId===r:!t.variantId));n&&n.id&&(yield w(n.id,t))}),[s,w]),P={items:s,loading:i,total:S,itemCount:C,addItem:k,updateQuantity:j,removeItem:E,clearCart:v};return m.jsx(B.Provider,{value:P,children:e})},U=h.createContext(void 0),Y=()=>{const e=h.useContext(U);if(!e)throw new Error("useWishlist must be used within a WishlistProvider");return e},Q=({children:e})=>{const{user:t}=q(),{showNotification:r}=F(),[s,n]=h.useState([]),[i,o]=h.useState(!0),a=h.useCallback(()=>u(null,null,function*(){if(!t)return n([]),void o(!1);o(!0);try{const e=(yield M.get("/wishlist")).data.map(e=>({id:e.id,product:{id:e.product_id,name:e.name,slug:e.slug,description:e.description,shortDescription:e.short_description,price:Number(e.price),originalPrice:e.original_price?Number(e.original_price):void 0,images:e.images,stock:Number(e.stock),rating:Number(e.rating),reviewCount:Number(e.review_count),isFeatured:e.is_featured,categoryId:e.category_id,category:e.category_name,createdAt:e.created_at},addedAt:new Date(e.created_at)}));n(e)}catch(e){r({type:"error",title:"Error",message:"Failed to fetch wishlist items. Please try again later."})}o(!1)}),[t,r]);h.useEffect(()=>{a()},[a]);const l=e=>u(null,null,function*(){if(t)try{yield M.delete(`/wishlist/${e}`),yield a(),r({type:"info",title:"Removed from Wishlist",message:"Item removed from your wishlist."})}catch(s){r({type:"error",title:"Error",message:"Failed to remove item from wishlist. Please try again later."})}}),c=e=>s.some(t=>t.product.id===e),d={items:s,addItem:e=>u(null,null,function*(){var s;if(!t)return void r({type:"info",title:"Authentication Required",message:"Please log in or create an account to add items to your wishlist."});if(c(e.id))yield l(e.id);else try{yield M.post("/wishlist",{productId:e.id}),yield a(),r({type:"success",title:"Added to Wishlist",message:`${e.name} added to your wishlist.`})}catch(n){409===(null==(s=n.response)?void 0:s.status)?r({type:"info",title:"Already in Wishlist",message:`${e.name} is already in your wishlist.`}):r({type:"error",title:"Error",message:"Failed to add item to wishlist. Please try again later."})}}),removeItem:l,isInWishlist:c,clearWishlist:()=>u(null,null,function*(){if(t)try{yield M.delete("/wishlist"),n([])}catch(e){r({type:"error",title:"Error",message:"Failed to clear wishlist. Please try again later."})}}),loading:i};return m.jsx(U.Provider,{value:d,children:e})},J=h.createContext(void 0),Z=()=>{const e=h.useContext(J);if(!e)throw new Error("useProducts must be used within a ProductProvider");return e},G=({children:e})=>{const[t,r]=h.useState([]),[s,n]=h.useState([]),[i,o]=h.useState([]),[a,c]=h.useState([]),[d,f]=h.useState([]),[g,p]=h.useState(!1),[y,b]=h.useState(!1),[w,x]=h.useState(!1),[v,S]=h.useState(!1),[C,k]=h.useState({page:1,limit:20,total:0,pages:0}),{setError:E}=N();h.useEffect(()=>{j()},[]),h.useEffect(()=>{P(1)},[]);const j=h.useCallback(()=>u(null,null,function*(){try{const e=yield M.getCategories();f(e.data||[])}catch(e){E(e instanceof Error?e.message:"Failed to fetch categories")}}),[E]),P=h.useCallback((e=1,t=20,s)=>u(null,null,function*(){try{p(!0);const n=yield M.getProducts(l({page:e,limit:t},s));r(n.data||[]),k(n.pagination),E(null)}catch(n){E(n instanceof Error?n.message:"Failed to fetch products")}finally{p(!1)}}),[E]),T=h.useCallback((e=10)=>u(null,null,function*(){try{b(!0);const t=yield M.getProducts({featured:!0,showOnHomepage:!0,limit:e});n(t.data||[])}catch(t){E(t instanceof Error?t.message:"Failed to fetch featured products")}finally{b(!1)}}),[E]),I=h.useCallback((e=8)=>u(null,null,function*(){try{x(!0);const t=yield M.getProducts({bestSellers:!0,limit:e});o(t.data||[])}catch(t){E(t instanceof Error?t.message:"Failed to fetch best sellers")}finally{x(!1)}}),[E]),R=h.useCallback((e=8)=>u(null,null,function*(){try{S(!0);const t=yield M.getProducts({latest:!0,showOnHomepage:!0,limit:e});c(t.data||[])}catch(t){E(t instanceof Error?t.message:"Failed to fetch latest products")}finally{S(!1)}}),[E]),O=h.useCallback(e=>u(null,null,function*(){try{return[]}catch(e){return E(e instanceof Error?e.message:"Failed to fetch reviews"),[]}}),[E]),A=h.useCallback(e=>u(null,null,function*(){try{const t=yield M.createProduct(e);return yield P(1),t}catch(t){throw E(t instanceof Error?t.message:"Failed to create product"),t}}),[E,P]),q=h.useCallback(e=>u(null,null,function*(){}),[E]),L=h.useCallback(e=>u(null,null,function*(){try{return yield M.getProduct(e)}catch(t){return E(t instanceof Error?t.message:"Failed to fetch product"),null}}),[E]),z=h.useCallback(e=>u(null,null,function*(){try{p(!0);const t=yield M.getProducts({search:e,limit:50});r(t.data||[]),k(t.pagination)}catch(t){E(t instanceof Error?t.message:"Search failed")}finally{p(!1)}}),[E]),F=h.useCallback(e=>u(null,null,function*(){try{p(!0);const t=yield M.getProducts({categoryId:e,limit:50});r(t.data||[]),k(t.pagination)}catch(t){E(t instanceof Error?t.message:"Filter failed")}finally{p(!1)}}),[E]),_=h.useCallback(e=>u(null,null,function*(){try{const t=yield M.createProduct(e);return yield P(1),t}catch(t){throw E(t instanceof Error?t.message:"Failed to create product"),t}}),[E,P]),D=h.useCallback(e=>u(null,null,function*(){try{const t=yield M.updateProduct(e.id,e);return yield P(C.page),t}catch(t){throw E(t instanceof Error?t.message:"Failed to update product"),t}}),[E,P,C.page]),W=h.useCallback(e=>u(null,null,function*(){try{yield M.deleteProduct(e),yield P(C.page)}catch(t){throw E(t instanceof Error?t.message:"Failed to delete product"),t}}),[E,P,C.page]),B=h.useCallback(e=>u(null,null,function*(){try{const t=yield M.createCategory(e);return yield j(),t}catch(t){throw E(t instanceof Error?t.message:"Failed to create category"),t}}),[E,j]),$=h.useCallback((e,t)=>u(null,null,function*(){try{const r=yield M.updateCategory(e,t);return yield j(),r}catch(r){throw E(r instanceof Error?r.message:"Failed to update category"),r}}),[E,j]),H=h.useCallback(e=>u(null,null,function*(){try{yield M.deleteCategory(e),yield j()}catch(t){throw E(t instanceof Error?t.message:"Failed to delete category"),t}}),[E,j]),U=h.useCallback(()=>{C.page<C.pages&&P(C.page+1)},[C,P]),Y=h.useCallback(()=>{C.page>1&&P(C.page-1)},[C,P]),Q=h.useCallback(e=>{e>=1&&e<=C.pages&&P(e)},[C,P]),Z={products:t,featuredProducts:s,bestSellers:i,latestProducts:a,categories:d,loading:g,featuredLoading:y,bestSellersLoading:w,latestLoading:v,pagination:C,fetchProducts:P,fetchFeaturedProducts:T,fetchBestSellers:I,fetchLatestProducts:R,fetchReviewsForProduct:O,fetchCategories:j,addProduct:A,submitReview:q,getProductById:L,searchProducts:z,filterByCategory:F,createProduct:_,updateProduct:D,deleteProduct:W,createCategory:B,updateCategory:$,deleteCategory:H,nextPage:U,previousPage:Y,goToPage:Q};return m.jsx(J.Provider,{value:Z,children:e})},V=h.createContext(void 0),X=()=>{const e=h.useContext(V);if(!e)throw new Error("useOrders must be used within an OrderProvider");return e},K=({children:e})=>{const{user:t}=q(),{showNotification:r}=F(),[s,n]=h.useState([]),[i,o]=h.useState(!1),a=h.useCallback(()=>u(null,null,function*(){if(t){o(!0);try{const e=yield M.getOrders();n(e.data||[])}catch(e){r({type:"error",title:"Error",message:"Failed to load orders. Please try again later."})}finally{o(!1)}}else n([])}),[t,r]);h.useEffect(()=>{a()},[a]);const l={orders:s,loading:i,createOrder:(e,s,n,i)=>u(null,null,function*(){var l;if(!t)return r({type:"error",title:"Authentication Required",message:"Please log in to place an order"}),null;o(!0);try{const t=e.map(e=>({product_id:e.product.id,productId:e.product.id,quantity:e.quantity,price:e.product.price,variantId:e.variantId})),o=yield M.createOrder({items:t,shippingAddress:s,billingAddress:s,paymentMethod:n,total:i});return(null==(l=o.data)?void 0:l.id)?(r({type:"success",title:"Order Placed",message:"Your order has been placed successfully!"}),yield a(),o.data.id):(r({type:"error",title:"Order Failed",message:"Failed to create order. Please try again."}),null)}catch(c){return r({type:"error",title:"Order Failed",message:"An unexpected error occurred. Please try again."}),null}finally{o(!1)}}),updateOrderStatus:(e,t)=>u(null,null,function*(){try{return yield M.updateOrderStatus(e,t),yield a(),r({type:"success",title:"Status Updated",message:`Order status updated to ${t}`}),!0}catch(s){return r({type:"error",title:"Update Failed",message:"Failed to update order status. Please try again later."}),!1}}),getOrderById:e=>u(null,null,function*(){try{return(yield M.getOrder(e)).data||null}catch(t){const r=s.find(t=>t.id===e);return r||null}}),getUserOrders:e=>u(null,null,function*(){if(!(e||(null==t?void 0:t.id)))return[];try{return(yield M.getOrders()).data||[]}catch(r){return[]}})};return m.jsx(V.Provider,{value:l,children:e})},ee=h.createContext(void 0),te=()=>{const e=h.useContext(ee);if(!e)throw new Error("useAddresses must be used within an AddressProvider");return e},re=({children:e})=>{const[t,r]=h.useState([]),[s,n]=h.useState(!1),{user:i}=q(),{showNotification:o}=F(),a=h.useCallback(()=>u(null,null,function*(){if(i){n(!0);try{const e=yield M.getAddresses();r(e.data||[])}catch(e){o({type:"error",title:"Error",message:"Failed to fetch addresses"})}finally{n(!1)}}else r([])}),[i,o]);h.useEffect(()=>{a()},[a]);const l={addresses:t,addAddress:e=>u(null,null,function*(){if(i)try{yield M.createAddress(e),yield a(),o({type:"success",title:"Address Added",message:"Your address has been added successfully"})}catch(t){o({type:"error",title:"Error",message:"Failed to add address"})}else o({type:"error",title:"Authentication Required",message:"Please log in to add an address"})}),updateAddress:e=>u(null,null,function*(){try{yield M.updateAddress(e.id,e),yield a(),o({type:"success",title:"Address Updated",message:"Your address has been updated successfully"})}catch(t){o({type:"error",title:"Error",message:"Failed to update address"})}}),deleteAddress:e=>u(null,null,function*(){try{yield M.deleteAddress(e),yield a(),o({type:"success",title:"Address Deleted",message:"Your address has been deleted successfully"})}catch(t){o({type:"error",title:"Error",message:"Failed to delete address"})}}),setDefaultAddress:(e,t)=>u(null,null,function*(){try{yield M.setDefaultAddress(e),yield a(),o({type:"success",title:"Default Address Set",message:`Default ${t} address has been updated`})}catch(r){o({type:"error",title:"Error",message:"Failed to set default address"})}}),fetchAddresses:a,loading:s};return m.jsx(ee.Provider,{value:l,children:e})},se={neutral:{primary:{50:"#f8fafc",100:"#f1f5f9",500:"#475569",600:"#334155",700:"#1e293b",900:"#020617"},secondary:{50:"#fafaf9",100:"#f5f5f4",500:"#78716c",600:"#57534e",700:"#44403c",900:"#1c1917"}},warm:{primary:{50:"#fef7ed",100:"#fdedd3",500:"#ea580c",600:"#dc2626",700:"#b91c1c",900:"#7c2d12"},secondary:{50:"#fefce8",100:"#fef3c7",500:"#eab308",600:"#ca8a04",700:"#a16207",900:"#713f12"}},cool:{primary:{50:"#eff6ff",100:"#dbeafe",500:"#3b82f6",600:"#2563eb",700:"#1d4ed8",900:"#1e3a8a"},secondary:{50:"#f0fdfa",100:"#ccfbf1",500:"#14b8a6",600:"#0d9488",700:"#0f766e",900:"#134e4a"}},vibrant:{primary:{50:"#fdf4ff",100:"#fae8ff",500:"#a855f7",600:"#9333ea",700:"#7c3aed",900:"#581c87"},secondary:{50:"#fef2f2",100:"#fee2e2",500:"#ef4444",600:"#dc2626",700:"#b91c1c",900:"#7f1d1d"}},monochrome:{primary:{50:"#f9fafb",100:"#f3f4f6",500:"#6b7280",600:"#4b5563",700:"#374151",900:"#111827"},secondary:{50:"#f9fafb",100:"#f3f4f6",500:"#6b7280",600:"#4b5563",700:"#374151",900:"#111827"}}},ne={compact:{fontFamily:{sans:["Inter","system-ui","sans-serif"],serif:["Playfair Display","Georgia","serif"],mono:["JetBrains Mono","Menlo","monospace"],display:["Cormorant Garamond","Playfair Display","serif"]},fontSize:{xs:{size:"0.75rem",lineHeight:"1rem"},sm:{size:"0.875rem",lineHeight:"1.25rem"},base:{size:"1rem",lineHeight:"1.5rem"},lg:{size:"1.125rem",lineHeight:"1.75rem"},xl:{size:"1.25rem",lineHeight:"1.75rem"},"2xl":{size:"1.5rem",lineHeight:"2rem"},"3xl":{size:"1.875rem",lineHeight:"2.25rem"},"4xl":{size:"2.25rem",lineHeight:"2.5rem"}},fontWeight:{light:300,normal:400,medium:500,semibold:600,bold:700}},comfortable:{fontFamily:{sans:["Inter","system-ui","sans-serif"],serif:["Playfair Display","Georgia","serif"],mono:["JetBrains Mono","Menlo","monospace"],display:["Cormorant Garamond","Playfair Display","serif"]},fontSize:{xs:{size:"0.8125rem",lineHeight:"1.125rem"},sm:{size:"0.9375rem",lineHeight:"1.375rem"},base:{size:"1.0625rem",lineHeight:"1.625rem"},lg:{size:"1.1875rem",lineHeight:"1.875rem"},xl:{size:"1.3125rem",lineHeight:"1.875rem"},"2xl":{size:"1.5625rem",lineHeight:"2.125rem"},"3xl":{size:"1.9375rem",lineHeight:"2.375rem"},"4xl":{size:"2.3125rem",lineHeight:"2.625rem"}},fontWeight:{light:300,normal:400,medium:500,semibold:600,bold:700}},spacious:{fontFamily:{sans:["Inter","system-ui","sans-serif"],serif:["Playfair Display","Georgia","serif"],mono:["JetBrains Mono","Menlo","monospace"],display:["Cormorant Garamond","Playfair Display","serif"]},fontSize:{xs:{size:"0.875rem",lineHeight:"1.25rem"},sm:{size:"1rem",lineHeight:"1.5rem"},base:{size:"1.125rem",lineHeight:"1.75rem"},lg:{size:"1.25rem",lineHeight:"2rem"},xl:{size:"1.375rem",lineHeight:"2rem"},"2xl":{size:"1.625rem",lineHeight:"2.25rem"},"3xl":{size:"2rem",lineHeight:"2.5rem"},"4xl":{size:"2.375rem",lineHeight:"2.75rem"}},fontWeight:{light:300,normal:400,medium:500,semibold:600,bold:700}}},ie={none:{sm:"0px",default:"0px",md:"0px",lg:"0px",xl:"0px",full:"0px"},small:{sm:"2px",default:"4px",md:"6px",lg:"8px",xl:"12px",full:"9999px"},medium:{sm:"4px",default:"6px",md:"8px",lg:"12px",xl:"16px",full:"9999px"},large:{sm:"6px",default:"8px",md:"12px",lg:"16px",xl:"24px",full:"9999px"},full:{sm:"9999px",default:"9999px",md:"9999px",lg:"9999px",xl:"9999px",full:"9999px"}},oe=()=>{const[e,t]=h.useState(()=>"undefined"==typeof window?{mode:"light",colorScheme:"neutral",fontScale:"comfortable",borderRadius:"medium",animationLevel:"normal",highContrast:!1,reducedMotion:!1}:function(){try{const e=localStorage.getItem("theme_preferences");if(e)return l(l({},{mode:"auto",colorScheme:"neutral",fontScale:"comfortable",borderRadius:"medium",animationLevel:"normal",highContrast:!1,reducedMotion:!1}),JSON.parse(e))}catch(e){}return{mode:"auto",colorScheme:"neutral",fontScale:"comfortable",borderRadius:"medium",animationLevel:"normal",highContrast:!1,reducedMotion:!1}}()),[r,s]=h.useState(()=>"undefined"==typeof window?{prefersDark:!1,prefersReducedMotion:!1,prefersHighContrast:!1}:ae()),n=h.useMemo(()=>{const t="light",r=se[e.colorScheme],s=ne[e.fontScale],n=ie[e.borderRadius],i=function(e){const t=!1;return{primary:e.primary||se.neutral.primary,secondary:e.secondary||se.neutral.secondary,accent:e.primary||se.neutral.primary,neutral:se.neutral.primary,semantic:{success:{50:"#f0fdf4",500:"#22c55e",600:"#16a34a",700:"#15803d"},warning:{50:"#fffbeb",500:"#f59e0b",600:"#d97706",700:"#b45309"},error:{50:"#fef2f2",500:"#ef4444",600:"#dc2626",700:"#b91c1c"},info:{50:"#eff6ff",500:"#3b82f6",600:"#2563eb",700:"#1d4ed8"}},background:{primary:t?"#0f172a":"#ffffff",secondary:t?"#1e293b":"#f8fafc",tertiary:t?"#334155":"#f1f5f9",overlay:t?"rgba(0, 0, 0, 0.8)":"rgba(255, 255, 255, 0.8)"},text:{primary:t?"#f8fafc":"#0f172a",secondary:t?"#cbd5e1":"#475569",tertiary:t?"#94a3b8":"#64748b",inverse:t?"#0f172a":"#f8fafc",disabled:t?"#64748b":"#94a3b8"},border:{subtle:t?"#334155":"#e2e8f0",default:t?"#475569":"#cbd5e1",strong:t?"#64748b":"#94a3b8",interactive:t?"#3b82f6":"#2563eb"}}}(r,0,e.highContrast);return{mode:t,colorScheme:e.colorScheme,colors:i,typography:s,spacing:{scale:"compact"===e.fontScale?.875:"spacious"===e.fontScale?1.125:1,base:16,sizes:le(e.fontScale)},borderRadius:e.borderRadius,animationLevel:e.reducedMotion?"none":e.animationLevel,fontScale:e.fontScale,customProperties:ce(i,s,n)}},[e,r]),i=h.useCallback(e=>{t(t=>{const r=l(l({},t),e);return function(e){try{localStorage.setItem("theme_preferences",JSON.stringify(e))}catch(t){}}(r),r})},[]);return h.useEffect(()=>{!function(e){const t=document.documentElement;Object.entries(e.customProperties).forEach(([e,r])=>{t.style.setProperty(e,r)}),t.className=t.className.replace(/theme-\w+/g,""),t.classList.add(`theme-${e.mode}`),t.classList.add(`color-scheme-${e.colorScheme}`),t.classList.add(`font-scale-${e.fontScale}`),t.classList.add(`border-radius-${e.borderRadius}`),t.classList.add(`animation-${e.animationLevel}`),t.style.colorScheme="light"}(n)},[n]),h.useEffect(()=>{const e=[window.matchMedia("(prefers-color-scheme: dark)"),window.matchMedia("(prefers-reduced-motion: reduce)"),window.matchMedia("(prefers-contrast: high)")],t=()=>{s(ae())};return e.forEach(e=>e.addEventListener("change",t)),()=>{e.forEach(e=>e.removeEventListener("change",t))}},[]),{preferences:e,themeConfig:n,systemPreferences:r,updatePreferences:i,resetToDefaults:()=>i({mode:"auto",colorScheme:"neutral",fontScale:"comfortable",borderRadius:"medium",animationLevel:"normal",highContrast:!1,reducedMotion:!1})}};function ae(){return{prefersDark:window.matchMedia("(prefers-color-scheme: dark)").matches,prefersReducedMotion:window.matchMedia("(prefers-reduced-motion: reduce)").matches,prefersHighContrast:window.matchMedia("(prefers-contrast: high)").matches||window.matchMedia("(-ms-high-contrast: active)").matches||window.matchMedia("(forced-colors: active)").matches}}function le(e){const t=16*("compact"===e?.875:"spacious"===e?1.125:1);return{xs:.25*t+"px",sm:.5*t+"px",md:1*t+"px",lg:1.5*t+"px",xl:2*t+"px","2xl":3*t+"px","3xl":4*t+"px","4xl":6*t+"px"}}function ce(e,t,r){const s={};return Object.entries(e.background).forEach(([e,t])=>{s[`--color-background-${e}`]=t}),Object.entries(e.text).forEach(([e,t])=>{s[`--color-text-${e}`]=t}),Object.entries(e.border).forEach(([e,t])=>{s[`--color-border-${e}`]=t}),s["--font-family-sans"]=t.fontFamily.sans.join(", "),s["--font-family-serif"]=t.fontFamily.serif.join(", "),s["--font-family-mono"]=t.fontFamily.mono.join(", "),Object.entries(r).forEach(([e,t])=>{s[`--border-radius-${e}`]=t}),s}const de=h.createContext(void 0),ue=({children:e})=>{const{preferences:t,themeConfig:r,systemPreferences:s,updatePreferences:n,resetToDefaults:i}=oe();h.useEffect(()=>{const e=`Theme changed to ${r.mode} mode with ${r.colorScheme} color scheme`,t=document.createElement("div");t.setAttribute("aria-live","polite"),t.setAttribute("aria-atomic","true"),t.className="sr-only",t.textContent=e,document.body.appendChild(t),setTimeout(()=>{document.body.contains(t)&&document.body.removeChild(t)},1e3)},[r.mode,r.colorScheme]);const o={themeConfig:r,preferences:t,systemPreferences:s,setMode:e=>n({mode:e}),setColorScheme:e=>n({colorScheme:e}),setFontScale:e=>n({fontScale:e}),setBorderRadius:e=>n({borderRadius:e}),setAnimationLevel:e=>n({animationLevel:e}),toggleHighContrast:()=>n({highContrast:!t.highContrast}),toggleReducedMotion:()=>n({reducedMotion:!t.reducedMotion}),updatePreferences:n,resetToDefaults:i,theme:r.mode,actualTheme:r.mode};return m.jsx(de.Provider,{value:o,children:e})},he=({isOpen:e,onClose:t,initialMode:r="login"})=>{const[s,n]=h.useState(r),[i,o]=h.useState(1),[a,d]=h.useState(!1),[f,p]=h.useState(!1),[y,b]=h.useState(!1),{login:P,signup:T}=q(),{showSuccess:M,showError:I}=F(),[R,N]=h.useState({email:"",password:""}),[O,A]=h.useState({email:"",password:"",confirmPassword:"",firstName:"",lastName:"",phone:""}),[L,z]=h.useState(""),_=e=>u(null,null,function*(){if(e.preventDefault(),1===i)return O.email&&O.password?O.password!==O.confirmPassword?void I("Validation Error","Passwords do not match"):O.password.length<6?void I("Validation Error","Password must be at least 6 characters"):void o(2):void I("Validation Error","Please fill in all fields");b(!0);try{yield T({email:O.email,password:O.password,firstName:O.firstName,lastName:O.lastName,phone:O.phone}),M("Success","Account created successfully!"),n("verify")}catch(t){I("Signup Failed",t.message||"Could not create account")}finally{b(!1)}}),D=()=>{N({email:"",password:""}),A({email:"",password:"",confirmPassword:"",firstName:"",lastName:"",phone:""}),z(""),o(1),d(!1),p(!1)},W=()=>{D(),t()},B=e=>{D(),n(e)};return e?m.jsxs(m.Fragment,{children:[m.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.7)",backdropFilter:"blur(8px)",zIndex:99998},onClick:W}),m.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem",zIndex:99999,pointerEvents:"none"},children:m.jsxs("div",{style:{position:"relative",backgroundColor:"white",borderRadius:"1rem",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",width:"100%",maxWidth:"500px",maxHeight:"90vh",overflow:"hidden",display:"flex",flexDirection:"column",pointerEvents:"auto"},onClick:e=>e.stopPropagation(),children:[m.jsxs("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"2rem",color:"white",position:"relative"},children:[m.jsx("button",{onClick:W,style:{position:"absolute",top:"1rem",right:"1rem",padding:"0.5rem",borderRadius:"0.5rem",border:"none",background:"rgba(255, 255, 255, 0.2)",color:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"background 0.2s"},onMouseEnter:e=>{e.currentTarget.style.background="rgba(255, 255, 255, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(255, 255, 255, 0.2)"},children:m.jsx(g,{className:"h-5 w-5"})}),"signup"===s&&2===i||"login"!==s&&"verify"!==s?m.jsx("button",{onClick:()=>{"signup"===s&&2===i?o(1):B("login")},style:{position:"absolute",top:"1rem",left:"1rem",padding:"0.5rem",borderRadius:"0.5rem",border:"none",background:"rgba(255, 255, 255, 0.2)",color:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"background 0.2s"},onMouseEnter:e=>{e.currentTarget.style.background="rgba(255, 255, 255, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(255, 255, 255, 0.2)"},children:m.jsx(x,{className:"h-5 w-5"})}):null,m.jsxs("div",{style:{textAlign:"center",marginTop:"1rem"},children:[m.jsx("div",{style:{width:"4rem",height:"4rem",background:"rgba(255, 255, 255, 0.2)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1rem"},children:"verify"===s?m.jsx(w,{className:"h-8 w-8"}):"forgot"===s||"reset"===s?m.jsx(v,{className:"h-8 w-8"}):m.jsx(S,{className:"h-8 w-8"})}),m.jsxs("h2",{style:{fontSize:"1.5rem",fontWeight:"bold",marginBottom:"0.5rem"},children:["login"===s&&"Welcome Back","signup"===s&&(1===i?"Create Account":"Complete Profile"),"forgot"===s&&"Reset Password","verify"===s&&"Check Your Email","reset"===s&&"New Password"]}),m.jsxs("p",{style:{opacity:.9,fontSize:"0.875rem"},children:["login"===s&&"Sign in to your account","signup"===s&&(1===i?"Join our community":"Tell us about yourself"),"forgot"===s&&"Enter your email to reset password","verify"===s&&"We sent a verification link","reset"===s&&"Enter your new password"]})]})]}),m.jsx("div",{style:{padding:"2rem",overflowY:"auto",flex:1},children:"verify"===s?m.jsxs("div",{style:{textAlign:"center"},children:[m.jsx("div",{style:{width:"5rem",height:"5rem",background:"#dcfce7",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1rem"},children:m.jsx(C,{className:"h-10 w-10 text-green-600"})}),m.jsx("p",{style:{color:"#6b7280",marginBottom:"1.5rem"},children:"Please check your email and click the verification link to continue."}),m.jsx("button",{onClick:W,style:{width:"100%",padding:"0.75rem",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",borderRadius:"0.5rem",fontSize:"1rem",fontWeight:600,cursor:"pointer"},children:"Got it"})]}):"login"===s?m.jsxs("form",{onSubmit:e=>u(null,null,function*(){e.preventDefault(),b(!0);try{yield P(R.email,R.password),M("Success","Logged in successfully!"),t()}catch(r){I("Login Failed",r.message||"Invalid credentials")}finally{b(!1)}}),style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[m.jsxs("div",{children:[m.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:500,color:"#374151"},children:"Email Address"}),m.jsxs("div",{style:{position:"relative"},children:[m.jsx(C,{className:"h-5 w-5 text-gray-400",style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)"}}),m.jsx("input",{type:"email",value:R.email,onChange:e=>N(c(l({},R),{email:e.target.value})),required:!0,style:{width:"100%",padding:"0.75rem 0.75rem 0.75rem 2.5rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"1rem",outline:"none"},onFocus:e=>{e.currentTarget.style.borderColor="#667eea",e.currentTarget.style.boxShadow="0 0 0 3px rgba(102, 126, 234, 0.1)"},onBlur:e=>{e.currentTarget.style.borderColor="#d1d5db",e.currentTarget.style.boxShadow="none"},placeholder:"you@example.com"})]})]}),m.jsxs("div",{children:[m.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:500,color:"#374151"},children:"Password"}),m.jsxs("div",{style:{position:"relative"},children:[m.jsx(k,{className:"h-5 w-5 text-gray-400",style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)"}}),m.jsx("input",{type:a?"text":"password",value:R.password,onChange:e=>N(c(l({},R),{password:e.target.value})),required:!0,style:{width:"100%",padding:"0.75rem 2.5rem 0.75rem 2.5rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"1rem",outline:"none"},onFocus:e=>{e.currentTarget.style.borderColor="#667eea",e.currentTarget.style.boxShadow="0 0 0 3px rgba(102, 126, 234, 0.1)"},onBlur:e=>{e.currentTarget.style.borderColor="#d1d5db",e.currentTarget.style.boxShadow="none"},placeholder:"••••••••"}),m.jsx("button",{type:"button",onClick:()=>d(!a),style:{position:"absolute",right:"0.75rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",padding:"0.25rem",display:"flex",alignItems:"center"},children:a?m.jsx(E,{className:"h-5 w-5 text-gray-400"}):m.jsx(j,{className:"h-5 w-5 text-gray-400"})})]})]}),m.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:m.jsx("button",{type:"button",onClick:()=>B("forgot"),style:{background:"none",border:"none",color:"#667eea",fontSize:"0.875rem",cursor:"pointer",fontWeight:500},children:"Forgot password?"})}),m.jsx("button",{type:"submit",disabled:y,style:{width:"100%",padding:"0.75rem",background:y?"#9ca3af":"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",borderRadius:"0.5rem",fontSize:"1rem",fontWeight:600,cursor:y?"not-allowed":"pointer",transition:"transform 0.2s"},onMouseEnter:e=>{y||(e.currentTarget.style.transform="translateY(-2px)")},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)"},children:y?"Signing in...":"Sign In"}),m.jsxs("div",{style:{textAlign:"center",marginTop:"1rem"},children:[m.jsx("span",{style:{color:"#6b7280",fontSize:"0.875rem"},children:"Don't have an account? "}),m.jsx("button",{type:"button",onClick:()=>B("signup"),style:{background:"none",border:"none",color:"#667eea",fontSize:"0.875rem",cursor:"pointer",fontWeight:600},children:"Sign up"})]})]}):"signup"===s&&1===i?m.jsxs("form",{onSubmit:_,style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[m.jsxs("div",{children:[m.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:500,color:"#374151"},children:"Email Address"}),m.jsxs("div",{style:{position:"relative"},children:[m.jsx(C,{className:"h-5 w-5 text-gray-400",style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)"}}),m.jsx("input",{type:"email",value:O.email,onChange:e=>A(c(l({},O),{email:e.target.value})),required:!0,style:{width:"100%",padding:"0.75rem 0.75rem 0.75rem 2.5rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"1rem",outline:"none"},onFocus:e=>{e.currentTarget.style.borderColor="#667eea",e.currentTarget.style.boxShadow="0 0 0 3px rgba(102, 126, 234, 0.1)"},onBlur:e=>{e.currentTarget.style.borderColor="#d1d5db",e.currentTarget.style.boxShadow="none"},placeholder:"you@example.com"})]})]}),m.jsxs("div",{children:[m.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:500,color:"#374151"},children:"Password"}),m.jsxs("div",{style:{position:"relative"},children:[m.jsx(k,{className:"h-5 w-5 text-gray-400",style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)"}}),m.jsx("input",{type:a?"text":"password",value:O.password,onChange:e=>A(c(l({},O),{password:e.target.value})),required:!0,style:{width:"100%",padding:"0.75rem 2.5rem 0.75rem 2.5rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"1rem",outline:"none"},onFocus:e=>{e.currentTarget.style.borderColor="#667eea",e.currentTarget.style.boxShadow="0 0 0 3px rgba(102, 126, 234, 0.1)"},onBlur:e=>{e.currentTarget.style.borderColor="#d1d5db",e.currentTarget.style.boxShadow="none"},placeholder:"••••••••"}),m.jsx("button",{type:"button",onClick:()=>d(!a),style:{position:"absolute",right:"0.75rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",padding:"0.25rem",display:"flex",alignItems:"center"},children:a?m.jsx(E,{className:"h-5 w-5 text-gray-400"}):m.jsx(j,{className:"h-5 w-5 text-gray-400"})})]})]}),m.jsxs("div",{children:[m.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:500,color:"#374151"},children:"Confirm Password"}),m.jsxs("div",{style:{position:"relative"},children:[m.jsx(k,{className:"h-5 w-5 text-gray-400",style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)"}}),m.jsx("input",{type:f?"text":"password",value:O.confirmPassword,onChange:e=>A(c(l({},O),{confirmPassword:e.target.value})),required:!0,style:{width:"100%",padding:"0.75rem 2.5rem 0.75rem 2.5rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"1rem",outline:"none"},onFocus:e=>{e.currentTarget.style.borderColor="#667eea",e.currentTarget.style.boxShadow="0 0 0 3px rgba(102, 126, 234, 0.1)"},onBlur:e=>{e.currentTarget.style.borderColor="#d1d5db",e.currentTarget.style.boxShadow="none"},placeholder:"••••••••"}),m.jsx("button",{type:"button",onClick:()=>p(!f),style:{position:"absolute",right:"0.75rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",padding:"0.25rem",display:"flex",alignItems:"center"},children:f?m.jsx(E,{className:"h-5 w-5 text-gray-400"}):m.jsx(j,{className:"h-5 w-5 text-gray-400"})})]})]}),m.jsx("button",{type:"submit",style:{width:"100%",padding:"0.75rem",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",borderRadius:"0.5rem",fontSize:"1rem",fontWeight:600,cursor:"pointer",transition:"transform 0.2s"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)"},children:"Continue"}),m.jsxs("div",{style:{textAlign:"center",marginTop:"1rem"},children:[m.jsx("span",{style:{color:"#6b7280",fontSize:"0.875rem"},children:"Already have an account? "}),m.jsx("button",{type:"button",onClick:()=>B("login"),style:{background:"none",border:"none",color:"#667eea",fontSize:"0.875rem",cursor:"pointer",fontWeight:600},children:"Sign in"})]})]}):"signup"===s&&2===i?m.jsxs("form",{onSubmit:_,style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[m.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[m.jsxs("div",{children:[m.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:500,color:"#374151"},children:"First Name"}),m.jsx("input",{type:"text",value:O.firstName,onChange:e=>A(c(l({},O),{firstName:e.target.value})),required:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"1rem",outline:"none"},onFocus:e=>{e.currentTarget.style.borderColor="#667eea",e.currentTarget.style.boxShadow="0 0 0 3px rgba(102, 126, 234, 0.1)"},onBlur:e=>{e.currentTarget.style.borderColor="#d1d5db",e.currentTarget.style.boxShadow="none"},placeholder:"John"})]}),m.jsxs("div",{children:[m.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:500,color:"#374151"},children:"Last Name"}),m.jsx("input",{type:"text",value:O.lastName,onChange:e=>A(c(l({},O),{lastName:e.target.value})),required:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"1rem",outline:"none"},onFocus:e=>{e.currentTarget.style.borderColor="#667eea",e.currentTarget.style.boxShadow="0 0 0 3px rgba(102, 126, 234, 0.1)"},onBlur:e=>{e.currentTarget.style.borderColor="#d1d5db",e.currentTarget.style.boxShadow="none"},placeholder:"Doe"})]})]}),m.jsxs("div",{children:[m.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:500,color:"#374151"},children:"Phone Number (Optional)"}),m.jsx("input",{type:"tel",value:O.phone,onChange:e=>A(c(l({},O),{phone:e.target.value})),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"1rem",outline:"none"},onFocus:e=>{e.currentTarget.style.borderColor="#667eea",e.currentTarget.style.boxShadow="0 0 0 3px rgba(102, 126, 234, 0.1)"},onBlur:e=>{e.currentTarget.style.borderColor="#d1d5db",e.currentTarget.style.boxShadow="none"},placeholder:"+1 (555) 000-0000"})]}),m.jsx("button",{type:"submit",disabled:y,style:{width:"100%",padding:"0.75rem",background:y?"#9ca3af":"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",borderRadius:"0.5rem",fontSize:"1rem",fontWeight:600,cursor:y?"not-allowed":"pointer",transition:"transform 0.2s"},onMouseEnter:e=>{y||(e.currentTarget.style.transform="translateY(-2px)")},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)"},children:y?"Creating Account...":"Create Account"})]}):"forgot"===s?m.jsxs("form",{onSubmit:e=>u(null,null,function*(){e.preventDefault(),b(!0);try{yield new Promise(e=>setTimeout(e,1e3)),M("Email Sent","Password reset link sent to your email"),n("verify")}catch(t){I("Error",t.message||"Could not send reset email")}finally{b(!1)}}),style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[m.jsxs("div",{children:[m.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:500,color:"#374151"},children:"Email Address"}),m.jsxs("div",{style:{position:"relative"},children:[m.jsx(C,{className:"h-5 w-5 text-gray-400",style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)"}}),m.jsx("input",{type:"email",value:L,onChange:e=>z(e.target.value),required:!0,style:{width:"100%",padding:"0.75rem 0.75rem 0.75rem 2.5rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"1rem",outline:"none"},onFocus:e=>{e.currentTarget.style.borderColor="#667eea",e.currentTarget.style.boxShadow="0 0 0 3px rgba(102, 126, 234, 0.1)"},onBlur:e=>{e.currentTarget.style.borderColor="#d1d5db",e.currentTarget.style.boxShadow="none"},placeholder:"you@example.com"})]})]}),m.jsx("button",{type:"submit",disabled:y,style:{width:"100%",padding:"0.75rem",background:y?"#9ca3af":"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",borderRadius:"0.5rem",fontSize:"1rem",fontWeight:600,cursor:y?"not-allowed":"pointer",transition:"transform 0.2s"},onMouseEnter:e=>{y||(e.currentTarget.style.transform="translateY(-2px)")},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)"},children:y?"Sending...":"Send Reset Link"})]}):null})]})})]}):null},me=h.createContext(void 0),fe=()=>{const e=h.useContext(me);if(!e)throw new Error("useAuthModal must be used within an AuthModalProvider");return e},ge=({children:e})=>{const[t,r]=h.useState(!1),[s,n]=h.useState(null),[i,o]=h.useState(null),a=()=>{r(!1),n(null),o(null)},l={showAuthModal:(e,t)=>{o(e),n(t),r(!0)},hideAuthModal:a,isModalOpen:t,modalAction:s,selectedProduct:i};return m.jsxs(me.Provider,{value:l,children:[e,t&&i&&f.createPortal(m.jsx(he,{isOpen:t,onClose:()=>{a()},initialMode:"login"}),document.body)]})},pe=h.createContext(void 0),ye=({children:e})=>{const{user:t}=q(),{showNotification:r}=F(),[s,n]=h.useState({isSecureConnection:!1,hasValidSession:!1,rateLimitStatus:{userCreation:!0,emailSending:!0}}),[i,o]=h.useState([]),[a,d]=h.useState("");h.useEffect(()=>{u(),f(),g();const e=setInterval(()=>{f(),y()},6e4);return()=>clearInterval(e)},[]);const u=()=>{const e="https:"===window.location.protocol||"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname;n(t=>c(l({},t),{isSecureConnection:e})),e||r({type:"warning",title:"Insecure Connection",message:"Please use HTTPS for secure data transmission."})},f=()=>{const e=!!t&&!!t.id;n(t=>c(l({},t),{hasValidSession:e}))},g=()=>{const e=btoa(Math.random().toString()).substr(10,32);d(e),sessionStorage.setItem("csrf_token",e)},p=e=>{o(t=>[...t,e]),"permission_denied"!==e.type&&"suspicious_activity"!==e.type||r({type:"error",title:"Access Denied",message:"You do not have permission to perform this action."})},y=()=>{o(e=>e.slice(-100))},b={isSecureConnection:s.isSecureConnection,hasValidSession:s.hasValidSession,rateLimitStatus:s.rateLimitStatus,checkPermission:(e,r)=>{if(!t)return p({type:"permission_denied",action:e,resource:r,details:{reason:"No authenticated user"},timestamp:new Date}),!1;const s=t.role,n={user_management:{create:["admin"],read:["admin","seller"],update:["admin"],delete:["admin"],bulk_operations:["admin"]},email_operations:{send_welcome:["admin"],send_confirmation:["admin"],resend_confirmation:["admin"]},system_settings:{read:["admin"],update:["admin"]}}[r||"user_management"];if(!n)return!1;const i=n[e];if(!i)return!1;const o=i.includes(s);return o||p({type:"permission_denied",action:e,resource:r,details:{userRole:s,requiredRoles:i},timestamp:new Date}),o},logSecurityEvent:p,validateCSRF:e=>e===sessionStorage.getItem("csrf_token")&&e===a};return m.jsx(pe.Provider,{value:b,children:e})},be=()=>{const[e,t]=h.useState({isOnline:navigator.onLine,isSlowConnection:!1,connectionType:"unknown",effectiveType:"unknown",downlink:0,rtt:0});return h.useEffect(()=>{const e=()=>{const e=navigator.connection||navigator.mozConnection||navigator.webkitConnection;t({isOnline:navigator.onLine,isSlowConnection:"2g"===(null==e?void 0:e.effectiveType)||"slow-2g"===(null==e?void 0:e.effectiveType),connectionType:(null==e?void 0:e.type)||"unknown",effectiveType:(null==e?void 0:e.effectiveType)||"unknown",downlink:(null==e?void 0:e.downlink)||0,rtt:(null==e?void 0:e.rtt)||0})},r=()=>e(),s=()=>e(),n=()=>e();window.addEventListener("online",r),window.addEventListener("offline",s);const i=navigator.connection;return i&&i.addEventListener("change",n),e(),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",s),i&&i.removeEventListener("change",n)}},[]),e};new class{constructor(e={}){d(this,"failures",0),d(this,"lastFailureTime",0),d(this,"state","closed"),d(this,"config"),d(this,"halfOpenSuccesses",0),d(this,"metrics",{requestCount:0,successCount:0,failureCount:0,averageResponseTime:0,bandwidthUsage:0,retryCount:0,circuitBreakerEvents:0}),d(this,"failureTimestamps",[]),this.config=l({failureThreshold:5,resetTimeout:6e4,monitoringPeriod:3e5,halfOpenAttempts:3},e)}execute(e){return u(this,null,function*(){this.metrics.requestCount++;const t=Date.now();if("open"===this.state){if(!(Date.now()-this.lastFailureTime>this.config.resetTimeout))throw new Error("Circuit breaker is open - service unavailable");this.state="half-open",this.halfOpenSuccesses=0,this.metrics.circuitBreakerEvents++}try{const r=yield e();"half-open"===this.state?(this.halfOpenSuccesses++,this.halfOpenSuccesses>=this.config.halfOpenAttempts&&(this.state="closed",this.failures=0,this.failureTimestamps=[],this.metrics.circuitBreakerEvents++)):this.metrics.successCount++;const s=Date.now()-t;return this.metrics.averageResponseTime=(this.metrics.averageResponseTime*(this.metrics.successCount-1)+s)/this.metrics.successCount,r}catch(r){this.failures++,this.lastFailureTime=Date.now(),this.failureTimestamps.push(this.lastFailureTime),this.metrics.failureCount++,this.metrics.circuitBreakerEvents++;const e=Date.now()-this.config.monitoringPeriod;this.failureTimestamps=this.failureTimestamps.filter(t=>t>e);const t=this.failureTimestamps.length;throw(this.failures>=this.config.failureThreshold||"half-open"===this.state||t>=this.config.failureThreshold&&"closed"===this.state)&&(this.state="open"),r}})}getState(){return{state:this.state,failures:this.failures,lastFailureTime:this.lastFailureTime,halfOpenSuccesses:this.halfOpenSuccesses,metrics:l({},this.metrics),recentFailureRate:this.failureTimestamps.length/(this.config.monitoringPeriod/1e3/60)}}reset(){this.state="closed",this.failures=0,this.lastFailureTime=0,this.halfOpenSuccesses=0,this.failureTimestamps=[]}getMetrics(){return l({},this.metrics)}}({failureThreshold:5,resetTimeout:6e4,monitoringPeriod:3e5,halfOpenAttempts:3}),new class{constructor(){d(this,"queue",[]),d(this,"isProcessing",!1),d(this,"maxRetries",3),d(this,"maxAge",864e5),d(this,"bandwidthThreshold",.5),d(this,"persistenceKey","offline-request-queue"),this.loadPersistedRequests(),window.addEventListener("online",()=>{this.processQueue()}),window.addEventListener("offline",()=>{this.persistQueue()}),setInterval(()=>{this.cleanupOldRequests()},6e4)}enqueue(e){return u(this,arguments,function*(e,t="normal",r=[],s=!1,n){return new Promise((i,o)=>{const a=`req_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,l=["critical","high","normal","low","background"],c=this.queue.findIndex(e=>l.indexOf(e.priority)>l.indexOf(t)),d={id:a,request:e,resolve:i,reject:o,timestamp:Date.now(),retries:0,priority:t,tags:r,persist:s,data:n};-1===c?this.queue.push(d):this.queue.splice(c,0,d),navigator.onLine?this.processQueue():s&&this.persistQueue()})})}processQueue(){return u(this,null,function*(){if(this.isProcessing||!navigator.onLine||0===this.queue.length)return;this.isProcessing=!0;const e=["critical","high","normal","low","background"];this.queue.sort((t,r)=>e.indexOf(t.priority)-e.indexOf(r.priority));const t=this.queue.filter(e=>"critical"===e.priority||"high"===e.priority),r=this.queue.filter(e=>"critical"!==e.priority&&"high"!==e.priority),s=(e,t=3)=>u(this,null,function*(){for(let r=0;r<e.length;r+=t){const s=e.slice(r,r+t);yield Promise.all(s.map(e=>u(this,null,function*(){try{const t=yield e.request();e.resolve(t),this.queue=this.queue.filter(t=>t.id!==e.id)}catch(t){e.retries++,e.retries<this.maxRetries?(e.priority=this.downgradePriority(e.priority),this.queue=this.queue.filter(t=>t.id!==e.id),this.queue.push(e)):(e.reject(t),this.queue=this.queue.filter(t=>t.id!==e.id))}})))}});t.length>0&&(yield s(t,3)),r.length>0&&(yield s(r,2)),this.isProcessing=!1,this.queue.length>0&&this.persistQueue()})}downgradePriority(e){const t=["critical","high","normal","low","background"],r=t.indexOf(e);if(r>=0&&r<t.length-1){const s=t[r+1];return null!=s?s:e}return e}cleanupOldRequests(){const e=Date.now();this.queue.length;this.queue=this.queue.filter(t=>{const r=e-t.timestamp>this.maxAge;return r&&t.reject(new Error("Request expired")),!r}),this.queue.length}getQueueStatus(){return{queueLength:this.queue.length,isProcessing:this.isProcessing,oldestRequest:this.queue.length>0&&this.queue[0]?this.queue[0].timestamp:null,priorityBreakdown:this.getPriorityBreakdown(),persistedRequests:this.queue.filter(e=>e.persist).length}}getPriorityBreakdown(){const e={critical:0,high:0,normal:0,low:0,background:0};return this.queue.forEach(t=>{e[t.priority]++}),e}clearQueue(){this.queue.forEach(e=>{e.reject(new Error("Queue cleared"))}),this.queue=[],this.clearPersistedQueue()}cancelRequestsByTag(e){const t=this.queue.length;this.queue=this.queue.filter(t=>!(t&&t.tags&&t.tags.includes(e))||(t.reject(new Error(`Request cancelled by tag: ${e}`)),!1)),t!==this.queue.length&&this.queue.some(e=>e.persist)&&this.persistQueue()}setBandwidthThreshold(e){this.bandwidthThreshold=e}persistQueue(){try{const e=this.queue.filter(e=>e.persist).map(e=>({id:e.id,timestamp:e.timestamp,retries:e.retries,priority:e.priority,tags:e.tags,data:e.data}));e.length>0?localStorage.setItem(this.persistenceKey,JSON.stringify(e)):this.clearPersistedQueue()}catch(e){}}loadPersistedRequests(){try{const e=localStorage.getItem(this.persistenceKey);if(e){JSON.parse(e)}}catch(e){}}clearPersistedQueue(){try{localStorage.removeItem(this.persistenceKey)}catch(e){}}sync(){return u(this,null,function*(){navigator.onLine&&(yield this.processQueue())})}};const we=h.createContext(void 0),xe=({children:e,showStatusBar:t=!0,enableGracefulDegradation:r=!0})=>{const s=be(),n=(()=>{const e=be(),[t,r]=h.useState("none");return h.useEffect(()=>{e.isOnline?e.isSlowConnection||e.downlink<.5?r("partial"):r("none"):r("full")},[e]),{networkStatus:e,degradationLevel:t,shouldLoadImages:"full"!==t,shouldLoadAnimations:"none"===t,shouldUseOptimizedQueries:"none"!==t,shouldShowOfflineMessage:"full"===t,shouldReduceImageQuality:"none"!==t}})(),[i,o]=h.useState(!1),[a,l]=h.useState("offline");h.useEffect(()=>{s.isOnline?s.isSlowConnection?(l("slow"),o(!0)):i&&"offline"===a?(l("restored"),setTimeout(()=>o(!1),3e3)):"slow"===a&&o(!1):(l("offline"),o(!0))},[s.isOnline,s.isSlowConnection]);const c=()=>u(null,null,function*(){try{JSON.parse(localStorage.getItem("failedErrorReports")||"[]").length>0&&localStorage.removeItem("failedErrorReports")}catch(e){}}),d={isOnline:s.isOnline,isSlowConnection:s.isSlowConnection,connectionType:s.connectionType,degradationLevel:r?n.degradationLevel:"none",shouldLoadImages:!r||n.shouldLoadImages,shouldLoadAnimations:!r||n.shouldLoadAnimations,shouldUseOptimizedQueries:!!r&&n.shouldUseOptimizedQueries,retryFailedRequests:c};return m.jsxs(we.Provider,{value:d,children:[e,t&&m.jsx(m.Fragment,{children:i&&m.jsx(ve,{config:(()=>{switch(a){case"offline":return{icon:m.jsx(T,{className:"h-5 w-5"}),title:"You're offline",message:"Some features may not work properly. We'll retry when you're back online.",bgColor:"bg-red-500",textColor:"text-white"};case"slow":return{icon:m.jsx(P,{className:"h-5 w-5"}),title:"Slow connection detected",message:"We've optimized the interface for better performance.",bgColor:"bg-orange-500",textColor:"text-white"};case"restored":return{icon:m.jsx(w,{className:"h-5 w-5"}),title:"Connection restored",message:"All features are now available.",bgColor:"bg-green-500",textColor:"text-white"};default:return null}})(),onRetry:c,onDismiss:()=>o(!1),showRetry:"offline"===a})})]})},ve=({config:e,onRetry:t,onDismiss:r,showRetry:s})=>e?m.jsx(motion.div,{initial:{opacity:0,y:-50},animate:{opacity:1,y:0},exit:{opacity:0,y:-50},className:`fixed top-0 left-0 right-0 ${e.bgColor} ${e.textColor} p-3 z-50 shadow-lg`,children:m.jsxs("div",{className:"container mx-auto flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center space-x-3",children:[e.icon,m.jsxs("div",{children:[m.jsx("div",{className:"font-medium text-sm",children:e.title}),m.jsx("div",{className:"text-xs opacity-90",children:e.message})]})]}),m.jsxs("div",{className:"flex items-center space-x-2",children:[s&&m.jsx("button",{onClick:t,className:"bg-white bg-opacity-20 hover:bg-opacity-30 px-3 py-1 rounded text-sm transition-colors",children:"Retry"}),m.jsx("button",{onClick:r,className:"bg-white bg-opacity-20 hover:bg-opacity-30 p-1 rounded transition-colors",children:"×"})]})]})}):null,Se=()=>{const e=(()=>{const e=h.useContext(we);if(!e)throw new Error("useNetwork must be used within a NetworkStatusProvider");return e})();return c(l({},e),{getImageProps:(t,r)=>e.shouldLoadImages?{src:t,alt:r,loading:"lazy"}:{src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjNmNGY2Ii8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5YTNhZiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkltYWdlPC90ZXh0Pjwvc3ZnPg==",alt:`${r} (Image loading disabled)`,loading:"lazy"},getAnimationProps:()=>e.shouldLoadAnimations?{}:{initial:!1,animate:!1,transition:{duration:0}},getQueryConfig:()=>e.shouldUseOptimizedQueries?{staleTime:3e5,cacheTime:6e5,refetchOnWindowFocus:!1,refetchOnReconnect:!0}:{staleTime:0,cacheTime:3e5,refetchOnWindowFocus:!1,refetchOnReconnect:!0}})},Ce=h.memo(({children:e})=>m.jsx(O,{children:m.jsx(ue,{children:m.jsx(_,{children:m.jsx(L,{children:m.jsx(ye,{children:m.jsx(ge,{children:m.jsx(G,{children:m.jsx(H,{children:m.jsx(Q,{children:m.jsx(K,{children:m.jsx(re,{children:m.jsx(xe,{children:e})})})})})})})})})})})}));Ce.displayName="CombinedProvider";const ke=(e=class{constructor(){d(this,"measurements",new Map),d(this,"metrics",[]),d(this,"maxMetrics",100)}static getInstance(){return e.instance||(e.instance=new e),e.instance}startMeasure(e){this.measurements.set(e,performance.now())}endMeasure(e,t=!0){const r=this.measurements.get(e);if(!r)return this.startMeasure(e),0;const s=performance.now()-r;return this.metrics.push({name:e,duration:s,timestamp:Date.now(),success:t}),this.metrics.length>this.maxMetrics&&this.metrics.shift(),this.measurements.delete(e),s}getStats(){const e=this.metrics.filter(e=>Date.now()-e.timestamp<3e5),t=e.filter(e=>e.success);if(0===e.length)return{totalRequests:0,successRate:0,averageTime:0,slowestOperation:null,fastestOperation:null};const r=t.map(e=>e.duration),s=r.reduce((e,t)=>e+t,0)/r.length,n=e.reduce((e,t)=>t.duration>e.duration?t:e),i=e.reduce((e,t)=>t.duration<e.duration?t:e);return{totalRequests:e.length,successRate:t.length/e.length*100,averageTime:s,slowestOperation:n,fastestOperation:i}}measureAsync(e,t){return u(this,null,function*(){this.startMeasure(e);try{const r=yield t();return this.endMeasure(e),r}catch(r){throw this.endMeasure(e),r}})}measureSync(e,t){this.startMeasure(e);try{const r=t();return this.endMeasure(e),r}catch(r){throw this.endMeasure(e),r}}},d(e,"instance"),e).getInstance();function Ee(e){if(!e||!e.message)return!1;const t=e.message.toLowerCase();return["infinite recursion","recursive reference","row-level security policy","rls recursion","policy recursion"].some(e=>t.includes(e))}new class{constructor(){d(this,"metrics",[]),d(this,"observers",[]),d(this,"isEnabled",!0),d(this,"detailedMetrics",{}),this.initializeObservers(),this.trackPageLoad()}initializeObservers(){if("undefined"!=typeof window&&"PerformanceObserver"in window)try{const t=new PerformanceObserver(e=>{var t;const r=e.getEntries(),s=r[r.length-1];this.recordMetric("lcp",s.startTime,"timing",{element:(null==(t=s.element)?void 0:t.tagName)||"unknown"}),this.detailedMetrics.lcp=s.startTime});t.observe({entryTypes:["largest-contentful-paint"]}),this.observers.push(t);const r=new PerformanceObserver(e=>{e.getEntries().forEach(e=>{this.recordMetric("fid",e.processingStart-e.startTime,"timing"),this.detailedMetrics.fid=e.processingStart-e.startTime})});r.observe({entryTypes:["first-input"]}),this.observers.push(r);try{const e=new PerformanceObserver(e=>{let t=0;e.getEntries().forEach(e=>{e.hadRecentInput||(t+=e.value)}),t>0&&(this.recordMetric("cls",t,"gauge"),this.detailedMetrics.cls=t)});e.observe({entryTypes:["layout-shift"]}),this.observers.push(e)}catch(e){}try{const e=new PerformanceObserver(e=>{e.getEntries().forEach(e=>{this.recordMetric("long_task",e.duration,"timing",{type:e.name}),this.detailedMetrics.longTasks=(this.detailedMetrics.longTasks||0)+1,this.detailedMetrics.longTaskDuration=(this.detailedMetrics.longTaskDuration||0)+e.duration})});e.observe({entryTypes:["longtask"]}),this.observers.push(e)}catch(e){}const s=new PerformanceObserver(e=>{e.getEntries().forEach(e=>{this.recordMetric("ttfb",e.responseStart-e.requestStart,"timing"),this.recordMetric("dom_content_loaded",e.domContentLoadedEventEnd-e.fetchStart,"timing"),this.recordMetric("load_complete",e.loadEventEnd-e.fetchStart,"timing"),this.detailedMetrics.ttfb=e.responseStart-e.requestStart})});s.observe({entryTypes:["navigation"]}),this.observers.push(s)}catch(e){this.isEnabled=!1}else this.isEnabled=!1}trackPageLoad(){"undefined"!=typeof window&&window.addEventListener("load",()=>{setTimeout(()=>{const e=performance.getEntriesByType("navigation")[0];e&&(this.recordMetric("ttfb",e.responseStart-e.requestStart,"timing"),this.recordMetric("dom_content_loaded",e.domContentLoadedEventEnd-e.fetchStart,"timing"),this.recordMetric("load_complete",e.loadEventEnd-e.fetchStart,"timing"),this.detailedMetrics.ttfb=e.responseStart-e.requestStart,this.detailedMetrics.domContentLoaded=e.domContentLoadedEventEnd-e.fetchStart,this.detailedMetrics.windowLoadTime=e.loadEventEnd-e.fetchStart,this.detailedMetrics.firstByteTime=e.responseStart-e.requestStart);performance.getEntriesByType("paint").forEach(e=>{this.recordMetric(e.name.replace("-","_"),e.startTime,"timing"),"first-contentful-paint"===e.name&&(this.detailedMetrics.fcp=e.startTime)});const t=performance.getEntriesByType("resource"),r=t.filter(e=>e.duration>1e3);this.recordMetric("slow_resources_count",r.length,"counter"),this.detailedMetrics.slowResourcesCount=r.length,this.detailedMetrics.totalResources=t.length,this.logPerformanceSummary()},1e3)})}recordMetric(e,t,r,s){if(!this.isEnabled)return;const n={name:e,value:t,timestamp:Date.now(),type:r,tags:s};this.metrics.push(n),this.checkPerformanceThresholds(n)}checkPerformanceThresholds(e){const t={lcp:2500,fid:100,cls:.1,ttfb:800,long_task:50,fcp:1800,image_load:3e3}[e.name];t&&e.value}logPerformanceSummary(){this.getPerformanceSummary()}getPerformanceSummary(){const e={},t=this.metrics.reduce((e,t)=>(e[t.name]||(e[t.name]=[]),e[t.name].push(t.value),e),{});return Object.entries(t).forEach(([t,r])=>{const s=r.reduce((e,t)=>e+t,0)/r.length,n=Math.max(...r),i=Math.min(...r);e[t]={average:Math.round(s),max:Math.round(n),min:Math.round(i),count:r.length}}),e}startTiming(e){const t=performance.now();return()=>{const r=performance.now()-t;this.recordMetric(e,r,"timing")}}trackComponentRender(e,t){this.recordMetric("component_render",t,"timing",{component:e})}trackDatabaseQuery(e,t,r){this.recordMetric("db_query",t,"timing",{query:e,success:r.toString()})}trackUserInteraction(e,t){this.recordMetric("user_interaction",t||1,"counter",{action:e})}trackImageLoad(e,t,r){this.recordMetric("image_load",t,"timing",{image:e,success:r.toString()}),r&&(this.detailedMetrics.imageLoadTime?this.detailedMetrics.imageLoadTime=(this.detailedMetrics.imageLoadTime+t)/2:this.detailedMetrics.imageLoadTime=t)}trackApiResponse(e,t,r){this.recordMetric("api_response",t,"timing",{endpoint:e,success:r.toString()}),r&&(this.detailedMetrics.apiResponseTime?this.detailedMetrics.apiResponseTime=(this.detailedMetrics.apiResponseTime+t)/2:this.detailedMetrics.apiResponseTime=t)}trackCachePerformance(e){this.recordMetric("cache_hit_rate",e,"gauge"),this.detailedMetrics.cacheHitRate=e}getAllMetrics(){return[...this.metrics]}getDetailedMetrics(){return l({},this.detailedMetrics)}clearMetrics(){this.metrics=[],this.detailedMetrics={}}destroy(){this.observers.forEach(e=>e.disconnect()),this.observers=[],this.metrics=[],this.detailedMetrics={}}};const je=({href:e,children:t})=>m.jsx("a",{href:e,className:"sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 focus:px-4 focus:py-2 focus:bg-blue-600 focus:text-white focus:rounded-md focus:shadow-lg",onFocus:e=>e.currentTarget.classList.remove("sr-only"),onBlur:e=>e.currentTarget.classList.add("sr-only"),children:t}),Pe=Object.freeze(Object.defineProperty({__proto__:null,SkipLink:je,initializeAccessibility:()=>{var e;if(!document.querySelector("main")){const t=document.querySelector('#main-content, .main-content, [role="main"]');if(t&&"MAIN"!==t.tagName){const r=document.createElement("main");r.id="main-content",null==(e=t.parentNode)||e.insertBefore(r,t),r.appendChild(t)}}document.addEventListener("keydown",e=>{if("Escape"===e.key){document.querySelectorAll('[role="dialog"][aria-hidden="false"]').forEach(e=>{const t=e.querySelector('[data-close], [aria-label*="close"]');t&&t.click()})}})}},Symbol.toStringTag,{value:"Module"}));const Te=new class{constructor(){d(this,"registration",null),d(this,"updateCheckInterval",null),this.setupUpdateChecking()}register(){return u(this,null,function*(){if(!this.isSupported())return null;try{return this.registration=yield navigator.serviceWorker.register("/sw.js",{scope:"/"}),this.registration.addEventListener("updatefound",()=>{var e;const t=null==(e=this.registration)?void 0:e.installing;t&&this.handleServiceWorkerUpdate(t)}),navigator.serviceWorker.addEventListener("message",e=>{this.handleServiceWorkerMessage(e)}),this.registration}catch(e){return null}})}unregister(){return u(this,null,function*(){if(!this.registration)return!1;try{const e=yield this.registration.unregister();return this.registration=null,this.updateCheckInterval&&(clearInterval(this.updateCheckInterval),this.updateCheckInterval=null),e}catch(e){return!1}})}update(){return u(this,null,function*(){if(this.registration)try{yield this.registration.update()}catch(e){}})}clearCache(){return u(this,null,function*(){return this.sendMessage("CLEAR_CACHE")})}getCacheStats(){return u(this,null,function*(){return(yield this.sendMessage("CACHE_STATS")).stats})}prefetchResources(e){return u(this,null,function*(){return this.sendMessage("PREFETCH_RESOURCES",{urls:e})})}isSupported(){return"serviceWorker"in navigator}getRegistration(){return this.registration}sendMessage(e,t){return u(this,null,function*(){if(!navigator.serviceWorker.controller)throw new Error("No service worker controller available");return new Promise((r,s)=>{const n=new MessageChannel;n.port1.onmessage=e=>{e.data.error?s(new Error(e.data.error)):r(e.data)},navigator.serviceWorker.controller.postMessage({type:e,payload:t},[n.port2])})})}handleServiceWorkerUpdate(e){e.addEventListener("statechange",()=>{"installed"===e.state&&navigator.serviceWorker.controller&&this.showUpdateNotification()})}handleServiceWorkerMessage(e){const{type:t,payload:r}=e.data;switch(t){case"CACHE_UPDATED":case"OFFLINE_READY":break;case"UPDATE_AVAILABLE":this.showUpdateNotification()}}showUpdateNotification(){window.dispatchEvent(new CustomEvent("sw-update-available",{detail:{registration:this.registration}}))}setupUpdateChecking(){this.updateCheckInterval=setInterval(()=>{this.registration&&this.update().catch(console.error)},18e5)}applyUpdate(){return u(this,null,function*(){this.registration&&this.registration.waiting&&(this.registration.waiting.postMessage({type:"SKIP_WAITING"}),window.location.reload())})}},Me=new class{constructor(e){d(this,"sw"),this.sw=e}prefetchCriticalResources(){return u(this,null,function*(){const e=["/assets/css/index.css","/assets/js/vendor.js","/assets/js/main.js"];try{yield this.sw.prefetchResources(e)}catch(t){}})}prefetchRoute(e){return u(this,null,function*(){const t=this.getRouteResources(e);try{yield this.sw.prefetchResources(t)}catch(r){}})}getCacheHealth(){return u(this,null,function*(){try{const e=yield this.sw.getCacheStats(),t=[];let r=0;return Object.entries(e).forEach(([e,s])=>{r+=s.entryCount||0,s.entryCount>100&&t.push(`${e} cache has many entries (${s.entryCount})`),s.exists||t.push(`${e} cache is not properly initialized`)}),{totalSize:r,cacheStatus:e,recommendations:t}}catch(e){return{totalSize:0,cacheStatus:{},recommendations:["Failed to get cache statistics"]}}})}getRouteResources(e){return{"/products":["/api/products","/api/categories"],"/dashboard":["/api/dashboard/analytics","/api/user/profile"],"/checkout":["/api/payment/methods","/api/shipping/options"]}[e]||[]}}(Te);"undefined"!=typeof window&&(window.addEventListener("load",()=>{Te.register().then(e=>{e&&Me.prefetchCriticalResources().catch(console.error)}).catch(console.error)}),window.addEventListener("online",()=>{Te.update().catch(console.error)}),window.addEventListener("offline",()=>{}));export{Ce as C,je as S,F as a,M as b,Z as c,Se as d,$ as e,fe as f,Y as g,X as h,te as i,N as j,Ee as k,Pe as l,ke as p,q as u};
